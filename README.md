# Проект "Анализ и предсказание размеров одежды для сайта интернет-магазина"

## Описание задачи

По главным антропометрическим данным (рост, вес, возраст) предсказывать предпочтительный размер одежды для покупок в интернет-магазинах.

## Описание датасета

**URL:** [Dataset](https://www.kaggle.com/datasets/tourist55/clothessizeprediction?select=final_test.csv)

Набор данных состоит из 4 столбцов:

- Вес (в кг)
- Возраст (лет)
- Рост (в см)
- Размер (L, S, M и т.д.)

Зависимой переменной является размер, а признаками — вес, возраст и рост.

## Особенности проекта (резултаты)

Финальная модель основана на случайном лесе. Модель предсказывет размер одежды из 6 заданных классов для которых выборка содержала приемлемое число обучающих примеров: XS, S, M, L, XL, XXL. Проводился подбор критериев срезки выбросов. Финальное значение взвешенной по классам F1-метрики на тестовом наборе ~0.5. В аналогичных проектах основанных на данном датасете достигнуты однако более высокие значения метрики, но это достигнкто за счёт более жестких срезок выбросов (|по z-score| > 3). Так же в аналогичных проектах был в качестве фичи поситан индекс массы тела (BMI), однако сам по себе, без применения срезок выбросов он мало что даёт к качеству [[Solution](https://www.kaggle.com/code/aisyahfadhlia/prak-dapros-5)]. Применение очень узких рамок параметров приводит к тому что модель может быть применима только к ограниченной части реальных данных, чего страраются избегать в этом проекте.

## Файлы проекта

- data -- содержит файл датасета для обучения
- Dockerfile -- файл создания образа Docker
- EDA+model_seach.ipynb -- файл юпитер-ноутбука для разведочного анализа данных и выбора модели
- README.md -- этот файл
- requirements.txt -- файл зависимостей для скриптов
- templates -- каталог Jinja-шаблонов для скрипта инференса
- training.py -- скрипт для обучения модели на базе случайного леса
- web_infer.py -- скрипт для инференса с WEB-интерфейсом

## Зависимости

### Общие

- Linux or WSL2
- python3 >= 3.8
- docker
- scikit-learn
- joblib
- pandas

### Дополнительно для скрипта инференса

- fastapi
- Jinja2
- pydantiс
- python-multipart
- uvicorn

**Предпочтительные версии пакетов Python указаны в requirements.txt**

### Дополнительно для EDA и поиска моделей

- Jupyter Notebook
- Matplotlib
- Seaborn
- LightGBM

## Установка

**Для дальнейших действий предпочтительно использовать Docker вместо прямого запуска скриптов**

В каталоге с проектом введите команду.

```
docker build . -t IMAGE_NAME
```

IMAGE_NAME -- любое допустимое имя образа докер.

## Обучение

```
docker run -it --rm -v model:/var/code/model IMAGE_NAME python ./training.py
```

Обученная модель сохраняется в томе model (может быть использовано другое допустимое имя). Контейнер автоматически удаляется после сохранения модели.

## Инференс

```
docker run -d -p PORT:8000 -v model:/var/code/model --name CONTAINER_NAME IMAGE_NAME
```

- CONTAINER_NAME -- имя контейнера
- PORT -- номер порта хост-машины на который привязывается сервис.

Запущенный сервис будет доступен по адресу localhost:PORT/
